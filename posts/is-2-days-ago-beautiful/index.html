<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Is `2.days.ago` a beautiful way of expressing a relative date?</title>
    <meta name="description" content="Is `2.days.ago` a beautiful way of expressing a date?">
    <link rel="stylesheet" href="/tech-blog/css/index.css">
    <link rel="stylesheet" href="/tech-blog/css/prism-base16-monokai.dark.css">
    <link rel="stylesheet" href="/tech-blog/assets/main.bundle.css">
    <script src="/tech-blog/assets/main.bundle.js"></script>
    <link rel="alternate" href="/tech-blog/feed/feed.xml" type="application/atom+xml" title="yosssizahn&#39;s tech blog">
    <link rel="alternate" href="/tech-blog/feed/feed.json" type="application/json" title="yosssizahn&#39;s tech blog">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,400;0,700;0,900;1,300;1,400;1,700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Cookie" rel="stylesheet">
  </head>
  <body class="mt-6">
    <div class="mx-auto max-w-3xl">
      <header class="mb-24">
        <ul class="flex justify-end">
          <li class="m-4">
            <a target="_blank" href="https://stackoverflow.com/users/8997905/yossizahn"><img width="24" src="/tech-blog/img/stack-overflow.png"/><a/></li>
            <li class="m-4">
              <a target="_blank" href="https://github.com/yossizahn"><img width="24" src="/tech-blog/img/github.png"/></a>
            </li>
            <li class="m-4">
              <a target="_blank" href="https://www.buymeacoffee.com/yossizahn"><img src="https://www.buymeacoffee.com/assets/img/BMC-btn-logo.svg" alt="Buy me a coffee"></a>
            </li>
          </ul>
          <h1 class="home mt-8 flex flex-col justify-center items-center">
            <img class="mx-auto" src="https://secure.gravatar.com/avatar/3f9dbf0ed722a4dbe777ead1b0775174.jpg?s=150&amp;d=mm" width="80" height="80" alt="Yossi Zahn Avatar">
            <a href="/tech-blog/" class="m-2 text-gray-700 font-bold  text-lg">yosssizahn&#39;s tech blog</a>
          </h1>
          <nav>
            <ul class="nav flex justify-center">
                <li class="nav-item m-4">
                  <a href="/tech-blog/"  class="text-gray-500 ">Home</a>
                </li>
                <li class="nav-item m-4">
                  <a href="/tech-blog/posts/"  class="text-gray-500 ">Archive</a>
                </li>
                <li class="nav-item m-4">
                  <a href="/tech-blog/about/"  class="text-gray-500 ">About Me</a>
                </li>
            </ul>
          </nav>
        </header>

        <main class="tmpl-post">
          <article class="prose">
<h1>Is `2.days.ago` a beautiful way of expressing a relative date?</h1>

<p>A common scenario: You need to calculate a date as a value relative to the current date.</p>
<p>Using the popular (albeit <a href="https://momentjs.com/docs/#/-project-status/">somewhat deprecated</a>) <a href="https://momentjs.com/">moment.js</a>, this can be expressed as follows:</p>
<pre class="language-javascript"><code class="language-javascript"><span class="token keyword">const</span> twoDaysAgo <span class="token operator">=</span> <span class="token function">moment</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">subtract</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token string">'days'</span><span class="token punctuation">)</span></code></pre>
<p>Nice. Readable. Sufficient.</p>
<p>I came across this curious Ruby snippet recently:</p>
<pre class="language-ruby"><code class="language-ruby">user <span class="token operator">=</span> User<span class="token punctuation">.</span>create<span class="token punctuation">(</span>
  <span class="token symbol">email</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'user@example.com'</span></span><span class="token punctuation">,</span>
  <span class="token symbol">trial_ends_at</span><span class="token operator">:</span> <span class="token number">30.</span>days<span class="token punctuation">.</span>from_now
<span class="token punctuation">)</span></code></pre>
<p>Ruby on Rails users may find this code somewhat familiar. For me this came as a big surprise.</p>
<p>After the initial double take, I tried understanding how this code actually works.<br>
<em>There is no way that Ruby-core offers <code>days</code> as a method on integers. That would just be too ludicrous to imagine.</em></p>
<p>Turns out, that Ruby allows (encourages?) extending native types, <em>and</em> this seems to be a popular practice. Whereas in JS land - where I live - it is generally frowned upon, in Ruby (on Rails?) it seems to be the norm to extend native types. There is even a utility library specifically for this purpose named <a href="https://guides.rubyonrails.org/active_support_core_extensions.html">Active Support</a>.</p>
<p>So... the <code>days</code> extension-method of integers, returns a <code>Duration</code> object. And duration objects apparently have an <code>ago</code> method, which returns a <code>Date</code> which is offset <code>$duration</code> amount of time into the past. Exhilarating? Beautiful?</p>
<p>Listen to what DHH (David Heinemeier Hansson, the creator of RoR) <a href="https://rubyonrails.org/doctrine/#optimize-for-programmer-happiness:~:text=But%20both%20decisions%20still%2C%20to%20this,Rails%20after%2012%20years%20of%20service.">has to say</a> about this style of coding:</p>
<blockquote>
<p>... both decisions still, to this day, make me smile. I relish getting to write <code>people.third</code> in a test case or the console. No, that‚Äôs not logical. It‚Äôs not efficient. It may even be pathological. But it continues to make me smile, thus fulfilling the principle and enriching my life, helping to justify my continued involvement with Rails after 12 years of service.</p>
</blockquote>
<p>Okay... <code>¬Ø\_(„ÉÑ)_/¬Ø</code></p>
<p>In my opinion this style of coding is not only bad, it is also <em>less readable and in a certain sense uglier</em>. &quot;Why?&quot; you may ask. Well in my mind, code is not prose. Code was never intended to be prose. And code that masquerades as prose requires more mental energy to translate it back into the code that it really is.</p>
<p>Disagree? You're welcome... Let me know in the comments. (Oops... no comments yet...)</p>
<h2 id="update-2023-07-16" tabindex="-1">Update 2023-07-16 <a class="direct-link" href="#update-2023-07-16">#</a></h2>
<p>Since I wrote this post <code>2.years.ago</code> üòâ I have become familiar with Smalltalk and clearly Ruby has inherited much from Smalltalk. <a href="https://pharo.org/">Pharo Smalltalk</a> has a method <code>days</code> on numbers which returns a <code>Duration</code>. The <code>ago</code> extension seems to be unique to RoR though.</p>


</article>
<ul class="my-12 text-gray-600" ><li>Next: <a href="/tech-blog/posts/split-sort/">‚ÄúSplit sort‚Äù with some bit twiddling</a></li><li>Previous: <a href="/tech-blog/posts/favourite-tools/" class="underline">My favorite tools</a></li>
</ul>

        </main>

        <footer></footer>

        <!-- Current page: /tech-blog/posts/is-2-days-ago-beautiful/ -->
      </div>
    </body>
  </html>
